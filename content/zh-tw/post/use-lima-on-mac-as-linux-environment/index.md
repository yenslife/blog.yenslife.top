+++
title = 'åœ¨ Mac ä¸Šä½¿ç”¨ lima ä½œç‚º Linux ç’°å¢ƒ'
date = 2022-07-05T18:35:07+08:00
draft = false
tags = ['Lima', 'Mac', 'Linux', 'picoCTF']
categories = ['Linux']
keywords = ['lima', 'Linux', 'picoCTF', 'Mac', 'èˆŠç¶²ç«™æ–‡ç« ']
description = 'åˆ†äº«æˆ‘å®‰è£å’Œä½¿ç”¨ lima çš„æ–¹å¼ï¼Œä»¥åŠé‡åˆ°çš„å•é¡Œã€‚å› ç‚ºæœ€è¿‘æƒ³æ‰“ picoCTFï¼Œéœ€è¦ä½¿ç”¨ Linux ç’°å¢ƒï¼Œæ–¼æ˜¯æ±ºå®šä½¿ç”¨ lima ä½œç‚ºæˆ‘çš„ Linux containerï¼Œé€™ç¯‡æ–‡ç« è¨˜éŒ„å®Œæ•´çš„å®‰è£ã€ä½¿ç”¨å’Œå•é¡Œè§£æ±ºéç¨‹ã€‚'
excerpt = 'åˆ†äº«æˆ‘å®‰è£å’Œä½¿ç”¨ lima çš„æ–¹å¼ï¼Œä»¥åŠé‡åˆ°çš„å•é¡Œã€‚åŒ…å«åœ¨ Mac ä¸Šè¨­å®š Linux ç’°å¢ƒã€è§£æ±ºè®€å¯«æ¬Šé™å•é¡Œç­‰å¯¦ç”¨æŠ€å·§ã€‚'
image = 'https://i.imgur.com/Ra8Ur5T.png'
toc = true
comments = true
author = 'æµ·ç‹¸å¤§å¸«'
authorLink = 'https://github.com/yenslife'
+++

ï¼ˆèˆŠç¶²ç«™æ–‡ç« ï¼Œæ’°å¯«æ™‚é–“ï¼š2022-07-05ï¼‰
## åœ¨ Mac ä¸Šä½¿ç”¨ lima ä½œç‚º Linux ç’°å¢ƒ
### ç›®éŒ„
1. [å®‰è£](#å®‰è£)
2. [ä½¿ç”¨æ–¹å¼](#ä½¿ç”¨æ–¹å¼)
3. [å•é¡Œä¸€ï¼ˆç„¡æ³•è®€å¯«çš„å•é¡Œï¼‰](#å•é¡Œä¸€ï¼ˆç„¡æ³•è®€å¯«çš„å•é¡Œï¼‰)

## å‰è¨€
å› ç‚ºæœ€è¿‘æƒ³æ‰“çœ‹çœ‹ picoCTFï¼Œéœ€è¦ä½¿ç”¨ Linux ç’°å¢ƒã€‚ç”±æ–¼æˆ‘ä½¿ç”¨çš„æ˜¯ MacOSï¼Œä»–ç•¢ç«Ÿä¸æ˜¯ Linuxï¼Œé›–ç„¶æœ‰äº›æŒ‡ä»¤å¯ä»¥é€šç”¨ï¼Œä½†åœ¨ç¨‹å¼åŸ·è¡Œçµæœä¸Šæœ‰å¾ˆå¤§çš„ä¸åŒã€‚æ–¼æ˜¯æˆ‘æ±ºå®šä½¿ç”¨ lima ä½œç‚ºæˆ‘çš„ Linux containerï¼ŒåŸæœ¬æœ‰æƒ³éè¦ç”¨ VMWare è™›æ“¬æ©Ÿçš„æ–¹å¼ï¼Œä½†æ˜¯ä¸€æƒ³åˆ°æ¯æ¬¡æˆ‘æƒ³æ‰“æ‰“ CTF å°±è¦è®“é€™å°è€ MacBook pro(late 2013)å—è‹¦å°±æ–¼å¿ƒä¸å¿ã€‚
äº‹å¯¦ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæˆ‘ä¸€é–‹ VMWareï¼Œè€å¤¥ä¼´çš„é¢¨æ‰‡å°±åˆé–‹å§‹å«äº†ğŸ¤§ã€‚

### å®‰è£
æˆ‘æ˜¯ä½¿ç”¨ [homebrew](https://brew.sh/index_zh-tw) å®‰è£çš„ï¼Œè¨˜å¾—åˆ°[å®˜æ–¹ç¶²ç«™](https://brew.sh/index_zh-tw)ä¸‹è¼‰å–”ã€‚å…ˆè¼¸å…¥ä»¥ä¸‹æŒ‡ä»¤ã€‚
```bash=
$ brew install lima # å®‰è£ lima
$ limactl start # å®‰è£è™›æ“¬æ©Ÿ
```
ç•¶å‡ºç¾ä»¥ä¸‹ç•«é¢ï¼Œä½¿ç”¨æ–¹å‘éµä¸Šä¸‹ä¾†é¸æ“‡é…ç½®ï¼Œæˆ‘å€‘åªè¦ç”¨é è¨­çš„å°±è¡Œäº†ï¼Œæ‰€ä»¥ç›´æ¥æŒ‰ enterï¼Œçœ‹åˆ°READYå°±æ˜¯å®Œæˆäº†ï¼
```bash=
? Creating an instance "default"  [Use arrows to move, type to filter]
> Proceed with the default configuration
  Open an editor to override the configuration
  Exit
...
INFO[0111] READY. Run `lima` to open the shell.
```
ä¸‹è¼‰å®Œæˆå¯ä»¥åŸ·è¡Œ`lima uname -a`ä¾†ç¢ºèªè™›æ“¬æ©Ÿå·²ç¶“åœ¨åŸ·è¡Œ
```bash=
$ Linux lima-default 5.15.0-39-generic #42-Ubuntu SMP Thu Jun 9 23:42:32 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux
```
### ä½¿ç”¨æ–¹å¼
ç›´æ¥åœ¨çµ‚ç«¯æ©Ÿè¼¸å…¥`lima`å°±å¯ä»¥åŸ·è¡Œäº†ï¼Œè‹¥è¦é›¢é–‹å°±ç›´æ¥è¼¸å…¥`exit`ã€‚
(~~å‰›è£å¥½æ™‚æˆ‘é‚„ä¸çŸ¥é“æ€éº¼é›¢é–‹ï¼Œæ‰€ä»¥éƒ½ç”¨å…©å€‹ terminal è¦–çª—ï¼Œä¸€å€‹æ˜¯ lima ä¸€å€‹æ˜¯ zshï¼Œä¸è¦è·Ÿæˆ‘ä¸€æ¨£è ¢å–”qq~~)
å¦‚æœæ²’æœ‰è¦ä½¿ç”¨è™›æ“¬æ©Ÿä¹Ÿè¨˜å¾—é—œæ‰å®ƒï¼Œä¸ç„¶ä»–æœƒé»˜é»˜åƒæ‰ä½ çš„è¨˜æ†¶é«”ï¼Œè¼¸å…¥`lima stop [è™›æ“¬æ©Ÿåç¨±]` ä¾†é—œé–‰è™›æ“¬æ©Ÿã€‚

![ç¤ºæ„åœ–](https://i.imgur.com/4v2K8Fw.png)

è‡³æ–¼å®¹å™¨çš„éƒ¨åˆ†æˆ‘é‚„æ²’ç ”ç©¶ï¼Œé€™æ˜¯ lima çš„å¼·é …ï¼Œå®ƒè¢«è™Ÿç¨±å¯ä»¥æˆç‚ºå–ä»£ docker çš„ macOS Subsystem Linuxã€‚ä½†ç•¢ç«Ÿæˆ‘åªæ˜¯éœ€è¦ä¸€å€‹æ–¹ä¾¿çš„ Linux ç’°å¢ƒä¾†ç·´CTFï¼Œæœ‰èˆˆè¶£çš„æœ‹å‹è«‹åƒè€ƒ[limaåŸå§‹ç¢¼](https://github.com/lima-vm/lima)ã€‚


### å•é¡Œä¸€ï¼ˆç„¡æ³•è®€å¯«çš„å•é¡Œï¼‰
å¦‚æœä½ åœ¨ lima æƒ³è¦ç”¨`mkdir`æŒ‡ä»¤ï¼Œæˆ–è€…ç”¨`vim`ç°¡å–®æ”¹ä¸€ä¸‹æª”æ¡ˆï¼Œå¯èƒ½æœƒå‡ºç¾é€™è¡Œã€‚
`lima mkdir cannot create directory Read-only file system`
æˆ‘åœ¨æ‰¾è³‡æ–™æ™‚ç™¼ç¾äº†[é€™ç¯‡å•ç­”](https://ithelp.ithome.com.tw/questions/10188327)ï¼ŒåŸæœ¬ä¹Ÿä»¥ç‚ºæ˜¯ç³»çµ±è³‡æ–™å‡ºå•é¡Œï¼Œä½†æˆ‘çš„æƒ…æ³å¥½åƒå’Œä»–ä¸å¤ªä¸€é …ã€‚å¾Œä¾†æˆ‘æ‰¾åˆ°é€™ç¯‡ [lima çš„  Github issue](https://github.com/lima-vm/lima/issues/34)ï¼Œç™¼ç¾å…¶å¯¦æ˜¯ [lima è¨­å®šæª”](https://github.com/lima-vm/lima/issues/34)çš„å•é¡Œã€‚ä»¥ä¸‹çš„æŒ‡ä»¤åœ¨ zsh æˆ– bash ä¸­éƒ½èƒ½ä½¿ç”¨ï¼Œå¦‚æœä½ åœ¨ lima shell ä¸­ä½¿ç”¨æœƒç™¼ç¾æ‰¾ä¸åˆ°é€™å€‹æª”æ¡ˆå–”ã€‚ç¸½ä¹‹å°±æ˜¯é–‹ mac åŸæœ¬çš„ terminal å°±å°äº†ã€‚è§£æ±ºæ–¹å¼å¦‚ä¸‹ã€‚
1. ä¿®æ”¹è¨­å®šæª”
```bash=
$ vim ~/.lima/default/lima.yaml # å…ˆç”¨ vim ç·¨è¼¯è¨­å®šæª”ã€‚
# æœ‰é»é•·æˆ‘å°±ä¸è²¼ä¸Šä¾†äº†ï¼Œæ‰¾åˆ° writable: null ä¸¦æ”¹æˆ writable: true
writable: null -> writable: true
```
2. é‡æ–°è·‘ lima
```bash=
$ limactl list  é€™å€‹æŒ‡ä»¤å¯ä»¥åˆ—å‡ºæ‰€æœ‰æ­£åœ¨åŸ·è¡Œçš„è™›æ“¬æ©Ÿï¼Œæˆ‘çœ‹åˆ°çš„æ˜¯åç‚º default çš„è™›æ“¬æ©Ÿ
$ limactl stop default  å°‡å®ƒåœæ­¢é‹è¡Œï¼Œdefault å¯ä»¥æ›¿æ›æˆä½ çš„è™›æ“¬æ©Ÿåç¨±
$ limactl start default  åŒä¸Šï¼Œdefault å¯ä»¥æ›¿æ›æˆä½ çš„è™›æ“¬æ©Ÿåç¨±
```
3. æ­å–œä½ æˆåŠŸäº†ï¼

### åƒè€ƒè³‡æ–™
[limaåŸå§‹ç¢¼](https://github.com/lima-vm/lima)
[åƒè€ƒè³‡æ–™(lima issue 34)](https://github.com/lima-vm/lima/blob/41fd9cc6a1e2bac73666e1f2b11604c7c42227dc/pkg/limayaml/default.TEMPLATE.yaml#L33-L41)
[åƒè€ƒè³‡æ–™(lima è¨­å®šæª”)](https://github.com/lima-vm/lima/issues/34)